<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>LastStandSecurity</title>
    <description>Blog containing CTF writeups from popular CTFs like HackTheBox, SANS Holiday Hack and NahamCon. Also contains OSINT tips and tricks. Sometimes posts random things about bugbounty, bitcoin and Pi Network
</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 15 Jul 2024 21:00:24 +0100</pubDate>
    <lastBuildDate>Mon, 15 Jul 2024 21:00:24 +0100</lastBuildDate>
    <generator>Jekyll v4.3.3</generator>
    
      <item>
        <title>Sofia Santos OSINT Challenge 028 write-up</title>
        <description>&lt;p&gt;As well as Cyber Security Operations, one of my other passions is OSINT. I’ve also recently been learning about &lt;a href=&quot;https://hive.com/blog/skill-stacking/&quot;&gt;skill stacking&lt;/a&gt;, which is a really intriuging concept and something I’m now actively trying to practice. With that in mind, I’m always looking for ways to expand and practice my OSINT skills. One of the tools I use for this is the excellent &lt;a href=&quot;https://gralhix.com/list-of-osint-exercises/&quot;&gt;OSINT challenges&lt;/a&gt; made by &lt;a href=&quot;https://x.com/Gralhix&quot;&gt;Sofia Santos&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Every so often she posts a new challenge with some preliminary information and a set of questions to solve. Recently she posted &lt;a href=&quot;https://gralhix.com/list-of-osint-exercises/osint-exercise-028/&quot;&gt;OSINT Challenge 028&lt;/a&gt;. As I’ve not published anything for far too long, I decided to write a blog post explaining how I solved the challenge.&lt;/p&gt;

&lt;h2 id=&quot;the-challenge&quot;&gt;The challenge&lt;/h2&gt;

&lt;p&gt;In this challenge, we are given a picture of what looks to be an abandoned building surrounded by quite a lot of foliage. There’s also a green gate with the number 55 on it and what looks to be either a green waste bin or a postbox. These small details, eg, the colour of the gate, the number on it, the foliage, are all important things to notice, as they might come in handy for the rest of the challenge.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028.jpg&quot; alt=&quot;OSINT Challenge 028 photo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We are also given the date of when the photo was taken - &lt;em&gt;20 September 2023, at 08:11 local time&lt;/em&gt;. This information is helpful for future parts of the challenge and is probably given here to help beginners, but it’s worth noting it can also be discovered when answering one of the challenge questions.&lt;/p&gt;

&lt;p&gt;The four questions posed for this challenge are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;a) What device I used to take the photograph?&lt;/li&gt;
  &lt;li&gt;b) Where I was headed?&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;c) How far I was from the entrance of my destination?&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Bonus challenge: In which hotel did I stay?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For each challenge, Sofia always rates the perceived difficulty of the challenge. For this particular challenge, these are rated as:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;For beginners: a) Medium, b) Easy, c) Medium.&lt;/li&gt;
  &lt;li&gt;For experts: a) Easy, b) Easy, c) Easy.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Whilst I don’t consider myself an OSINT expert by any means, I did find most of these fairly easy except the bonus question. Sometimes the difficulty mainly depends on how recently you’ve used a particular set of skills - happily for me it’s not long since I’ve had to use the skills listed below, so that probably explains why I didn’t struggle too much here. The rest of this blog shows my methodology for answering each of these questions.&lt;/p&gt;

&lt;h2 id=&quot;question-1---what-device-i-used-to-take-the-photograph&quot;&gt;Question 1 - What device I used to take the photograph?&lt;/h2&gt;
&lt;p&gt;This question is pretty straightforward really for anyone who may have ever done any photo editing or has a large photo library, or of course anyone interested in OSINT.&lt;/p&gt;

&lt;p&gt;All photos taken by modern devices store &lt;a href=&quot;https://en.wikipedia.org/wiki/Exif&quot;&gt;EXIF data&lt;/a&gt; within the image. This can be very useful during OSINT investigations to establish when a photo was taken or the device used. In some cases, if the device used supports this and it is enabled, EXIF data can even store the geo co-ordinates for where the image was taken.&lt;/p&gt;

&lt;p&gt;If you’re thinking all of this sounds a bit dystopian and could be misused, you’d be right. Fortunately, major social media providers (facebook, twitter, instagram) are all wise to this and remove EXIF data from images when posted &lt;a href=&quot;https://exifviewerapp.com/exif-data-in-social-media-what-you-need-to-know/&quot;&gt;https://exifviewerapp.com/exif-data-in-social-media-what-you-need-to-know/&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In this case though, the EXIF data has been left in the image, as after all, how would we solve the challenge otherwise?&lt;/p&gt;

&lt;p&gt;There are two main ways to view EXIF data depending on what operating system you are using. If you’re on windows, the easiest way is to just download the image, right click and view properties. If EXIF data exists in the image, Windows will present that data in the properties:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-properties.png&quot; alt=&quot;Windows Image Properties&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If you’re using a Linux based OS, you can use &lt;a href=&quot;https://exiftool.org/&quot;&gt;exiftool&lt;/a&gt; to achieve the same effect:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-exiftool.png&quot; alt=&quot;EXIF data from exiftool&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Whichever method you use, you find yourself to the same answer - the device used to take the photo was - &lt;em&gt;samsung SM-A125F&lt;/em&gt; which is the model number of a &lt;a href=&quot;https://en.wikipedia.org/wiki/Samsung_Galaxy_A12&quot;&gt;Samsung Galaxy A12&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In itself this in some way helps to answer the later questions - the photo was taken on a mobile phone rather than any expensive DLSR or other camera. This implies the person taking the photo was travelling, it’s probably a quick snap and not something they had time to prepare and compose.&lt;/p&gt;

&lt;p&gt;Note also how the date and time of the photo are also present in the EXIF data and match the detail given in the original challenge. As mentioned before, I suspect this detail was given to allow people not familiar with EXIF data to be able to have a go at the challenge, but anyone who was familiar with EXIF would have been able to figure this out for themselves.&lt;/p&gt;

&lt;h2 id=&quot;question-2---where-i-was-headed&quot;&gt;Question 2 - Where I was headed?&lt;/h2&gt;
&lt;p&gt;This question is where things start to get a bit trickier. With just a photo, device model and a date, how can we figure out where someone is going? The key to this question is less technical and more putting together the evidence and doing a bit of google dorking. We know that Sofia has a strong online presence across twitter and LinkedIn. We also know the date the photo was taken. It’s not unreasonable to assume that if Sofia was travelling somewhere and taking photos of it on her phone, she might then post about it.&lt;/p&gt;

&lt;p&gt;To check our theory, we need some way of searching her posts around the time the photo was taken. Now of course, we could do this manually, but given how prolific a poster she is, scrolling back to September 2023, almost one year ago, would take a lot of time.&lt;/p&gt;

&lt;p&gt;We can therefore use the power of &lt;a href=&quot;&quot;&gt;google dorking&lt;/a&gt; to find us the answer. Google is a great search engine. It indexes many many things. Hackers have long since discovered this and used advanced keywords to look for things that should never have been indexed, eg, sensitive directories, admin panels, website misconfigurations. This is commonly called google dorking. For this particular job, we need to find some google keywords that allow us to search around a specific timeframe, for a specific site.&lt;/p&gt;

&lt;p&gt;Enter &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;before&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;after&lt;/code&gt; &lt;a href=&quot;https://www.searchenginejournal.com/before-after-search-commands/302695/&quot;&gt;https://www.searchenginejournal.com/before-after-search-commands/302695/&lt;/a&gt;. These search operators allow you to search google within a particular timeframe.&lt;/p&gt;

&lt;p&gt;We know the post has to have occurred after the photo was taken, so for the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;after&lt;/code&gt; keyword, we specify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;after:2023-09-20&lt;/code&gt;. We don’t know when the post might have been made though, so we can assume any time in the following week, therefore &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;before:2023-09-27&lt;/code&gt;. This will search all posts within that timerange.&lt;/p&gt;

&lt;p&gt;However, we only want to search Sofia’s posts, not the whole internet, so we need to use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;site&lt;/code&gt; keyword. By specifying this, we tell google to search only one specific site. In this case, we can use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;site:twitter.com/Gralhix&lt;/code&gt;, thus making our full search string: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;site:twitter.com/Gralhix after:2023-09-20 before:2023-09-27&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;This returns exactly one result:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-googleresult.png&quot; alt=&quot;Google search result&quot; /&gt;&lt;/p&gt;

&lt;p&gt;which links to &lt;a href=&quot;https://x.com/Gralhix/status/1705952428468605325&quot;&gt;https://x.com/Gralhix/status/1705952428468605325&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-tweet.png&quot; alt=&quot;Tweet of interest&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So we now know from this tweet that she was headed to the &lt;strong&gt;“SIRIUS CTF Finale: The role of #women in #OSINT investigations”&lt;/strong&gt; event. From the rest of the tweet, we learn that this was hosted by Europol. One of the photos on the tweet shows a person wearing a Europol visitors badge, which implies that the person in the picture visiting a Europol building.&lt;/p&gt;

&lt;p&gt;The simplest way to find where this building might be is to simply google “Europol”, which tells us what the organisation is and where they are based:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-europol.png&quot; alt=&quot;Europol google entry&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This tells us the street where the building is based (Eisenhowerlaan) and even the building number (73). We can then verify that this is correct by visiting the area on google maps:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-europolmap.png&quot; alt=&quot;Europol google maps&quot; /&gt;&lt;/p&gt;

&lt;p&gt;To categorically answer this question then - Sofia was headed to the Europol building at &lt;strong&gt;78 Eisenhowerlaan, The Netherlands.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;question-3---how-far-i-was-from-the-entrance-of-my-destination&quot;&gt;Question 3 - How far I was from the entrance of my destination?&lt;/h2&gt;
&lt;p&gt;Now this question is where things get really interesting. We know where Sofia was headed. We know she took a photo on her mobile and that it was early in the morning. From the bonus question, we know she stayed in a hotel. We can therefore make a couple of assumptions. From the time of the photo (08:11), she was headed to Europol. Generally meetings would start around 8:30-09:00, so at 08:11, she can’t have been that far away. This is an interesting assumption to keep in mind while attempting to answer this question, however, a fundamental rule of OSINT is that all assumptions should be proven, so we need to find a way to figure out the exact location of the photo.&lt;/p&gt;

&lt;p&gt;At this point we will use one one of the simplest tools available to OSINT analysts - reverse image search. If you’ve never done this before, the principle is that google and other search engines normally search based on text input. However the modern internet is full of images. Google and others therefore now have functionality to provide an image as the search object, then the search engine will attempt to find matching images. To do this on google, just go to a google home page and press the camera icon to the right of the search box.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-googlesearch.png&quot; alt=&quot;Google image search&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This will ask for an image as input. Once this has been provided, google will find images similar to the one provided:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-googleimagesearch.png&quot; alt=&quot;Google reverse image search&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The task of the OSINT analyst now is to analyse each of the images on the right - do they match the input image? Are they in a similar location? We already know that Sofia was in the Netherlands, so we can discount any images from other locations. After examining all of the results, none appear to match our input image.&lt;/p&gt;

&lt;p&gt;Another great feature of google reverse image search is that it allows you to focus on a particular part of the picture to try and match. It does this using the familiar crop style tool, so you can crop the image on the fly to tell google which part of the image you want to match. As OSINT Analysts, this allows us to focus on certain objects or buildings, all of which can be very useful if we feel that particular items or objects in the picture are distinctive and more likely to yield results.&lt;/p&gt;

&lt;p&gt;In this case, perhaps the most distinctive item in the original picture is the building itself, so we focus the search on this area.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-googleimagesearchcropped.png&quot; alt=&quot;Google reverse image search cropped&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Aside from the first result, which is a link back to Sofia’s blog (always funny when that happens), the second result immediately springs out because of the address - eisenhowerlaan 59-61. This links back to question 2, where we discovered that the Europol building is at Eisenhowerlaan 74. As such we investigate this image by going over to &lt;a href=&quot;https://www.flickr.com/photos/klaasfotocollectie/3043686035/in/photostream/&quot;&gt;flickr&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-flickr.png&quot; alt=&quot;Flickr result&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While the building doesn’t look exactly the same as the building in the original picture, there are several architectural similarities, including the drains in use, the angular window bays and the type of brick in use.&lt;/p&gt;

&lt;p&gt;The easiest way to prove one way or another however is to head over to Google Maps or Google Earth and check out the building on streetview. By doing this and looking around, we soon realise that although the image found via reverse image search isn’t the building we were looking for, the one next door is!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-eisenhowerlaan.png&quot; alt=&quot;55 Eisenhowerlaan&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By looking around and comparing to Sofia’s original image, we can match various features to confirm that this is the same building - the green drain coming down the side of the building, the green gate with the number 55 on it, the green postbox, the cut off tree stump. All of these match, which proves that this is the same building.&lt;/p&gt;

&lt;p&gt;With that, we can work out the answer to the original question - &lt;strong&gt;“How far I was from the entrance of my destination?”“&lt;/strong&gt;. This is a straightforward matter of using google maps to work out the distance:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sofiasantos-028-distance.png&quot; alt=&quot;Distance from entrance&quot; /&gt;&lt;/p&gt;

&lt;p&gt;According to google, the photo was roughly &lt;strong&gt;80m&lt;/strong&gt; from the entrance of the final destination of the Europol building. Depending on how precise the answer needs to be, there’s probably a little more distance that can be added walking round the building to find the entrance.&lt;/p&gt;

&lt;h2 id=&quot;bonus-question---in-which-hotel-did-i-stay&quot;&gt;Bonus Question - In which hotel did I stay?&lt;/h2&gt;
&lt;p&gt;I’ll be completely honest here - I didn’t manage to solve this one. I did spend some time trying, but unfortunately I ran out of time and just wanted to get the blog post out.&lt;/p&gt;

&lt;p&gt;In the hopes that this might be useful to some others, I’ll list what I tried here:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Reverse image search on the picture of the challenge coin - this brings up Sofia’s LinkedIn post about the same event, where she states that the picture was taken from her hotel balcony&lt;/li&gt;
  &lt;li&gt;With that in mind, I spent some time looking for hotels near the Hague that look similar to the hotel you can see in the distance, with three columns and three black objects on the top - unfortunately, no joy.&lt;/li&gt;
  &lt;li&gt;I then spent some time trying to figure out a possible route Sofia could have taken to Europol (we already know at least part of the walking route), in the hope that this would lead back to the initial hotel - again no joy&lt;/li&gt;
  &lt;li&gt;As a last ditch attempt, I went to booking.com, typed in hotels in The Hague and looked through the pictures for a hotel matching the description above - again - no joy&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I reckon it must be solvable by just reading her other tweets and LinkedIn posts, but I didn’t want to cheat by doing it this way. If I get a bit more time, I might come back and have another go, but for now it will have to remain unsolved.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;This exercise was a lot of fun!! One of the things I like most about this style of OSINT challenge is getting to see different towns and cities and broadening my geographical horizons. I don’t think prior to this I’ve ever looked at the Netherlands in any greate detail, nor did I know where Europol were based. OSINT truly is a window to the world and I would encourage anyone to have a go if they’re interested!&lt;/p&gt;

</description>
        <pubDate>Sat, 13 Jul 2024 00:00:00 +0100</pubDate>
        <link>http://localhost:4000/2024-07/Sofia-Santos-OSINT-Exercise-028-write-up</link>
        <guid isPermaLink="true">http://localhost:4000/2024-07/Sofia-Santos-OSINT-Exercise-028-write-up</guid>
        
        
        <category>writeups</category>
        
        <category>OSINT</category>
        
      </item>
    
      <item>
        <title>SANS Holiday Hack 2020</title>
        <description>&lt;p&gt;Every year since 2016, I’ve taken part in the SANS Holiday Hack challenge. I can easily say it’s the best CTF of the year. To be honest though, I don’t tend to think of it as a CTF, as there isn’t so much of a competition element to it. Unless you want there to be, that is! More on that later.&lt;/p&gt;

&lt;p&gt;SANS call it their annual gift to the community and boy do they mean it! It seems to get better every single year. There is a massive game like environment where you can interact with other players, usually somewhere around 12 main challenges and a similar number of side-quests.&lt;/p&gt;

&lt;p&gt;Most people are happy with just completing all of the challenges and/or side challenges. This goes back to the competitiveness aspect discussed earlier. If you choose to, you can compile a write-up of how you’ve solved each challenge and what you’ve learnt from it, then submit this to SANS before the deadline (usually a month after the start of holiday hack).&lt;/p&gt;

&lt;p&gt;The reports are then judged by SANS and the winner receives a free SANS course! Plus there are a few different categories of winners who get prizes too. Just below the prize giving places, there are the Super Honourable Mentions and Honourable Mentions. These are for people whose reports were of a particularly good quality, but not quite on a par with the winners.&lt;/p&gt;

&lt;p&gt;What sort of challenges exist in Holiday Hack? EVERYTHING!! Some of my favourites from the last few years include:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Android reverse engineering [2016]&lt;/li&gt;
  &lt;li&gt;Apache Struts exploitation [2017]&lt;/li&gt;
  &lt;li&gt;QR code SQL Injection [2018]&lt;/li&gt;
  &lt;li&gt;Optical key decoding [2019]&lt;/li&gt;
  &lt;li&gt;Blockchain editing [2020]&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now, having said that I’ve done Holiday Hack every year since 2016, how have I fared?&lt;/p&gt;

&lt;p&gt;2016 was my first year, so I was just finding my feet and didn’t even submit a report. 2017 I knew what I was getting in for and managed to make a more sustained effort, but fell just short of completing all of the objectives. I submitted a report, but didn’t expect anything for it. 2018 was similar - I think I managed almost all of the objectives and submitted a report, but it wasn’t quite good enough.&lt;/p&gt;

&lt;p&gt;This brings me to 2019 and 2020. 2019 was a good year! The challenges were particularly good and I really enjoyed solving them. I think I completed all but two challenges. This got me my first honourable mention, which I was incredibly happy with!!&lt;/p&gt;

&lt;p&gt;Then the year just gone, 2020, was the first year I completed all of the objectives in the game. I didn’t complete all the side-quests, just all the main objectives. That alone was enough for me really and I was happy to just leave it there. Having started though, I wanted to submit a report. So I wrote up the best report I could and - got another honourable mention!! I don’t know if lockdown was the clinching factor this year and not having a commute, therefore more time to work on holiday hack, but whatever - it led to me being able to do more in holiday hack than ever before.&lt;/p&gt;

&lt;p&gt;In the spirit of sharing, the link to my 2020 Holiday Hack report is &lt;a href=&quot;../assets/pdf/holidayhack2020.pdf&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;As for Holiday Hack 2021 - I’ve not decided if I’m doing it yet, it does take a lot of time, which is time away from the family at an important time in the year. That said, I say every year I won’t spend as much time on it yet end up doing so. I will be sure to write it up here though if I get any sort of mention!!&lt;/p&gt;
</description>
        <pubDate>Sat, 20 Mar 2021 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/2021-03/sans-holiday-hack</link>
        <guid isPermaLink="true">http://localhost:4000/2021-03/sans-holiday-hack</guid>
        
        
        <category>writeups</category>
        
      </item>
    
      <item>
        <title>BSides Manchester 2019 - An Introduction to OWASP Juice Shop</title>
        <description>&lt;p&gt;My first conference talk - &lt;a href=&quot;https://www.youtube.com/watch?v=hlgp7oeVpac&quot;&gt;An Introduction to OWASP Juice Shop&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 20 Aug 2019 00:00:00 +0100</pubDate>
        <link>http://localhost:4000/2019-08/BSides-Manchester-An_Introduction-to-OWASP-Juice-Shop</link>
        <guid isPermaLink="true">http://localhost:4000/2019-08/BSides-Manchester-An_Introduction-to-OWASP-Juice-Shop</guid>
        
        
        <category>speaking</category>
        
      </item>
    
  </channel>
</rss>